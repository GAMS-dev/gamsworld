* AMPL Model by Hande Y. Benson
*
* Copyright (C) 2001 Princeton University
* All Rights Reserved
*
* Permission to use, copy, modify, and distribute this software and
* its documentation for any purpose and without fee is hereby
* granted, provided that the above copyright notice appear in all
* copies and that the copyright notice and this
* permission notice appear in all supporting documentation.

*   Source:
*   Francois Grondin (francois.grondin@qc.forintek.ca)
*   Forintek Canada Corp, 319, rue Franquet, Quebec, G1P 4R4, CANADA

*   SIF input: Nick Gould, Dec 1997.

*   classification QOR2-AN-583-774

$Set n 195
$Set m 4
Set I /i0*i%n%/;
Set j /j0*j%m%/;
Set left(j)      /j1*j%m%/;
Set left_left(j) /j2*j%m%/;

Parameter R ; R = 2500;

Parameter x[i]
            / i0     0.0   ,   i1     2.54  ,   i2     5.08  ,   i3     7.62001,
              i4    10.1612,   i5    12.7012,   i6    15.2412,   i7    17.7812,
              i8    20.3212,   i9    22.8612,  i10    25.4012,  i11    27.9412,
             i12    30.4812,  i13    33.0212,  i14    35.5612,  i15    38.1012,
             i16    40.6411,  i17    43.1811,  i18    45.7231,  i19    48.2631,
             i20    50.8031,  i21    53.3431,  i22    55.8839,  i23    58.4239,
             i24    60.965 ,  i25    63.505 ,  i26    66.045 ,  i27    68.585 ,
             i28    71.125 ,  i29    73.665 ,  i30    76.205 ,  i31    78.745 ,
             i32    81.285 ,  i33    83.825 ,  i34    86.365 ,  i35    88.905 ,
             i36    91.445 ,  i37    93.985 ,  i38    96.525 ,  i39    99.065 ,
             i40   101.605 ,  i41   104.145 ,  i42   106.685 ,  i43   109.225 ,
             i44   111.766 ,  i45   114.306 ,  i46   116.847 ,  i47   119.387 ,
             i48   121.927 ,  i49   124.467 ,  i50   127.008 ,  i51   129.548 ,
             i52   132.09  ,  i53   134.63  ,  i54   137.17  ,  i55   139.71  ,
             i56   142.251 ,  i57   144.791 ,  i58   147.33  ,  i59   149.87  ,
             i60   152.41  ,  i61   154.95  ,  i62   157.49  ,  i63   160.03  ,
             i64   162.571 ,  i65   165.111 ,  i66   167.651 ,  i67   170.191 ,
             i68   172.731 ,  i69   175.271 ,  i70   177.811 ,  i71   180.351 ,
             i72   182.891 ,  i73   185.431 ,  i74   187.972 ,  i75   190.512 ,
             i76   193.052 ,  i77   195.592 ,  i78   198.133 ,  i79   200.673 ,
             i80   203.213 ,  i81   205.753 ,  i82   208.293 ,  i83   210.833 ,
             i84   213.374 ,  i85   215.914 ,  i86   218.456 ,  i87   220.996 ,
             i88   223.536 ,  i89   226.076 ,  i90   228.616 ,  i91   231.156 ,
             i92   233.696 ,  i93   236.236 ,  i94   238.776 ,  i95   241.316 ,
             i96   243.856 ,  i97   246.396 ,  i98   248.936 ,  i99   251.476 ,
            i100   254.016 , i101   256.556 , i102   259.095 , i103   261.635 ,
            i104   264.176 , i105   266.716 , i106   269.256 , i107   271.797 ,
            i108   274.337 , i109   276.877 , i110   279.417 , i111   281.957 ,
            i112   284.497 , i113   287.037 , i114   289.577 , i115   292.117 ,
            i116   294.657 , i117   297.197 , i118   299.736 , i119   302.276 ,
            i120   304.815 , i121   307.355 , i122   309.895 , i123   312.435 ,
            i124   314.976 , i125   317.516 , i126   320.056 , i127   322.598 ,
            i128   325.138 , i129   327.678 , i130   330.215 , i131   332.755 ,
            i132   335.295 , i133   337.835 , i134   340.375 , i135   342.915 ,
            i136   345.454 , i137   347.994 , i138   350.534 , i139   353.074 ,
            i140   355.615 , i141   358.155 , i142   360.695 , i143   363.235 ,
            i144   365.773 , i145   368.313 , i146   370.853 , i147   373.393 ,
            i148   375.933 , i149   378.473 , i150   381.012 , i151   383.552 ,
            i152   386.09  , i153   388.632 , i154   391.17  , i155   393.71  ,
            i156   396.25  , i157   398.79  , i158   401.329 , i159   403.869 ,
            i160   406.41  , i161   408.95  , i162   411.49  , i163   414.03  ,
            i164   416.57  , i165   419.11  , i166   421.65  , i167   424.19  ,
            i168   426.729 , i169   429.269 , i170   431.81  , i171   434.35  ,
            i172   436.891 , i173   439.431 , i174   441.972 , i175   444.512 ,
            i176   447.052 , i177   449.592 , i178   452.134 , i179   454.674 ,
            i180   457.214 , i181   459.754 , i182   462.295 , i183   464.835 ,
            i184   467.375 , i185   469.915 , i186   472.455 , i187   474.995 ,
            i188   477.535 , i189   480.075 , i190   482.616 , i191   485.156 ,
            i192   487.696 , i193   490.236 , i194   492.776 , i195   495.316 /;
Parameter y[i]
   / i0      3.556    ,  i1     3.56346  ,  i2     3.57091  ,  i3     3.57837  ,
     i4      3.59371  ,  i5     3.60213  ,  i6     3.61055  ,  i7     3.61898  ,
     i8      3.6274   ,  i9     3.63582  , i10     3.6423   , i11     3.65073  ,
     i12     3.6653   , i13     3.67381  , i14     3.68233  , i15     3.69084  ,
     i16     3.50637  , i17     3.51498  , i18     2.77481  , i19     2.78376  ,
     i20     2.79272  , i21     2.80168  , i22     2.78529  , i23     2.79415  ,
     i24     2.47602  , i25     2.48617  , i26     2.48369  , i27     2.49377  ,
     i28     2.27635  , i29     2.28521  , i30     2.26744  , i31     2.27605  ,
     i32     2.28465  , i33     2.29325  , i34     2.4907   , i35     2.49921  ,
     i36     2.50773  , i37     2.51624  , i38     2.53381  , i39     2.54241  ,
     i40     2.74855  , i41     2.75716  , i42     2.76576  , i43     2.77437  ,
     i44     2.60758  , i45     2.6161   , i46     2.26008  , i47     2.2686   ,
     i48     2.28695  , i49     2.29556  , i50     1.47808  , i51     1.4854   ,
     i52     1.1101   , i53     1.1188   , i54     1.12749  , i55     1.13619  ,
     i56     0.978377 , i57     0.987075 , i58     0.82203  , i59     0.829676 ,
     i60     0.837322 , i61     0.844885 , i62     0.852781 , i63     0.86051  ,
     i64     0.538377 , i65     0.546996 , i66     0.600516 , i67     0.609224 ,
     i68     0.789128 , i69     0.798084 , i70     1.00996  , i71     1.01883  ,
     i72     1.03712  , i73     1.04591  , i74     0.720837 , i75     0.699625 ,
     i76     0.708414 , i77     0.717203 , i78     0.609086 , i79     0.617627 ,
     i80     0.199369 , i81     0.207992 , i82     0.225288 , i83     0.233831 ,
     i84    -0.172432 , i85    -0.163889 , i86    -0.34889  , i87    -0.341233 ,
     i88    -0.333576 , i89    -0.32592  , i90    -0.522016 , i91    -0.514426 ,
     i92    -0.506837 , i93    -0.499248 , i94    -0.491658 , i95    -0.484069 ,
     i96    -0.47648  , i97    -0.46889  , i98    -0.462453 , i99    -0.455008 ,
     i100   -0.447563 , i101   -0.440118 , i102    0.055237 , i103    0.063873 ,
     i104    0.062826 , i105    0.070575 , i106   -0.275144 , i107   -0.275842 ,
     i108   -0.268089 , i109   -0.260335 , i110   -0.118406 , i111   -0.110665 ,
     i112   -0.102923 , i113   -0.095181 , i114    0.103362 , i115    0.111028 ,
     i116    0.131239 , i117    0.138981 , i118    0.27243  , i119    0.280024 ,
     i120    0.421614 , i121    0.429144 , i122    0.436674 , i123    0.444203 ,
     i124    0.484027 , i125    0.491804 , i126    0.515482 , i127    0.571256 ,
     i128    0.580224 , i129    0.589193 , i130    1.11182  , i131    1.12071  ,
     i132    1.34551  , i133    1.35448  , i134    1.38382  , i135    1.39287  ,
     i136    1.77298  , i137    1.78202  , i138    2.00633  , i139    2.01544  ,
     i140    2.41293  , i141    2.42093  , i142    2.39029  , i143    2.39823  ,
     i144    2.89123  , i145    2.89911  , i146    3.33714  , i147    3.34509  ,
     i148    3.40441  , i149    3.41248  , i150    3.70271  , i151    3.71094  ,
     i152    4.15353  , i153    4.12735  , i154    4.56011  , i155    4.56923  ,
     i156    4.77252  , i157    4.78163  , i158    4.89149  , i159    4.89935  ,
     i160    4.96478  , i161    4.97272  , i162    5.16767  , i163    5.17553  ,
     i164    5.38577  , i165    5.39364  , i166    5.40151  , i167    5.40937  ,
     i168    5.28358  , i169    5.29136  , i170    5.14203  , i171    5.14865  ,
     i172    4.80067  , i173    4.80729  , i174    4.86169  , i175    4.86947  ,
     i176    4.56159  , i177    4.56937  , i178    3.78824  , i179    3.79602  ,
     i180    3.8038   , i181    3.81158  , i182    3.66534  , i183    3.67306  ,
     i184    3.67665  , i185    3.6845   , i186    3.6904   , i187    3.69832  ,
     i188    3.70624  , i189    3.71416  , i190    3.50154  , i191    3.50963  ,
     i192    3.51772  , i193    3.52581  , i194    3.5339   , i195    3.54199  /;

Parameter dx  ; dx  = x['i15']-x['i0'] ;
Parameter dy  ; dy  = y['i15']-y['i0'] ;
Parameter m_0 ; m_0 = dy/dx;

Variable  a[j] , p[i] , pprime[i] , pprime2[i] , f ;

Equation cons1[i] , cons2[i] , cons3[i] , cons4[i] ,
         cons5    , cons6    , Def_obj ;

cons1[i].. sum{j             , (a[j]*power(x[i],{ord(j)-1}) ) }   -p[i] =e=  0;
cons2[i].. sum{j$left(j)     , (a[j]*(ord(j)-1)               *power(x[i],({ord(j)-1}-1)))}
                                                              -pprime[i] =e=  0;
cons3[i].. sum{j$left_left(j), (a[j]*(ord(j)-1)*({ord(j)-1}-1)*power(x[i],({ord(j)-1}-2)))}
                                                              -pprime2[i]=e=0;
cons4[i].. R*R*pprime2[i]*pprime2[i]-power{ (1+pprime[i]*pprime[i]) ,3 } =l= 0;
cons5..    p['i0'] =e= y['i0'];
cons6..    pprime['i0'] =e=  m_0;

Def_obj.. f =e= sum{i,sqr(p[i]-y[i]) };

Model sawpath /all /;

Solve sawpath  using nlp minimazing f ;

display f.l;
display p.l, pprime.l, pprime2.l, a.l;
